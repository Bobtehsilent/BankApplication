{% extends 'base.html' %}

{% block content %}
<div class="breadcrumb-section">
    <div class="breadcrumb">
        {% if 'breadcrumb' in session %}
            {% for crumb in session['breadcrumb'] %}
                <a href="{{ crumb.url }}">{{ crumb.name }}</a>
                {% if not loop.last %}
                    &gt;
                {% endif %}
            {% endfor %}
        {% endif %}
    </div>
    <!-- Back Button -->
    <a href="javascript:history.back()" class="back">‚Üê Back</a>
</div>
<div class="transaction-container">
    <!-- Add Transaction Card -->
    <div class="card" id="addTransactionCard">
        <div class="card-header" onclick="toggleCollapse('addTransactionForm')">
            <h2>Add Transaction</h2>
        </div>
        <div id="addTransactionForm" class="card-body collapse">
            <form method="POST" action="{{ url_for('transaction.add_transaction', account_id=account.Id) }}">
                {{ add_transaction_form.hidden_tag() }}
                <div class="form-group">
                    {{ add_transaction_form.amount.label(class='form-label') }} {{ add_transaction_form.amount(class='form-control', id='amount') }}
                </div>
                <div class="form-group">
                    {{ add_transaction_form.operation.label(class='form-label') }} {{ add_transaction_form.operation(class='form-control', id='operation') }}
                </div>
                <div class="form-group">
                    {{ add_transaction_form.submit(class='form-submit-button') }}
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Transaction Action -->
    <div class="card" id="deleteTransactionCard">
        <div class="card-header" onclick="confirmDeleteTransaction()">
            <h2>Delete Transaction</h2>
        </div>
    </div>
</div>

<script>
function toggleCollapse(elementId) {
    var element = document.getElementById(elementId);
    if (element.classList.contains('collapse')) {
        element.classList.remove('collapse');
        element.classList.add('show');
    } else {
        element.classList.add('collapse');
        element.classList.remove('show');
    }
}

function confirmDeleteTransaction() {
    // JavaScript for handling delete confirmation
}

document.addEventListener('DOMContentLoaded', function() {
    var amountInput = document.getElementById('amount');
    var operationSelect = document.getElementById('operation');

    function updateOperationOptions() {
        var amount = parseFloat(amountInput.value) || 0;
        var creditOptions = [
            {value: 'Deposit cash', text: 'Deposit cash'},
            {value: 'Salary', text: 'Salary'},
            {value: 'Transfer to', text: 'Transfer to'}
        ];
        var debitOptions = [
            {value: 'ATM withdrawal', text: 'ATM withdrawal'},
            {value: 'Payment', text: 'Payment'},
            {value: 'Bank withdrawal', text: 'Bank withdrawal'},
            {value: 'Transfer from', text: 'Transfer from'}
        ];

        var options = amount >= 0 ? creditOptions : debitOptions;
        operationSelect.innerHTML = '';

        options.forEach(function(opt) {
            var option = new Option(opt.text, opt.value);
            operationSelect.add(option);
        });
    }

    // Initial update in case there's a default amount value
    updateOperationOptions();

    // Update operations when the amount changes
    amountInput.addEventListener('input', updateOperationOptions);
});


</script>
{% endblock %}