{% extends 'base.html' %}

{% block title %}New transaction{% endblock %}

{% block content %}
<div class="container">
    <h2>Add Transaction</h2>
    <form method="POST" action="{{ url_for('transaction.add_transaction', account_id=account_id) }}">
        {{ form.hidden_tag() }}
        <div class="form-group">
            {{ form.transaction_type.label }} {{ form.transaction_type(class='form-control', id='transaction_type') }}
        </div>
        <div class="form-group">
            {{ form.amount.label }} {{ form.amount(class='form-control') }}
        </div>
        <div class="form-group">
            {{ form.operation.label }} {{ form.operation(class='form-control', id='operation') }}
        </div>
        <div class="form-group">
            {{ form.submit(class='btn btn-primary') }}
        </div>
    </form>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    var transactionType = document.getElementById('transaction_type');
    var operation = document.getElementById('operation');

    function updateOperationOptions(transactionTypeValue) {
        var creditOptions = [
            {value: 'Deposit cash', text: 'Deposit cash'},
            {value: 'Salary', text: 'Salary'},
            {value: 'Transfer', text: 'Transfer'}
        ];

        var debitOptions = [
            {value: 'ATM withdrawal', text: 'ATM withdrawal'},
            {value: 'Payment', text: 'Payment'},
            {value: 'Bank withdrawal', text: 'Bank withdrawal'},
            {value: 'Transfer', text: 'Transfer'}
        ];

        var options = transactionTypeValue === 'Credit' ? creditOptions : debitOptions;
        operation.innerHTML = ''; 

        options.forEach(function(opt) {
            var option = new Option(opt.text, opt.value);
            operation.add(option);
        });
    }

    updateOperationOptions(transactionType.value);

    transactionType.addEventListener('change', function() {
        updateOperationOptions(this.value);
    });
});
</script>
{% endblock %}